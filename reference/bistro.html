<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify human contributors to a bloodmeal using STR profiles — bistro • bistro</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify human contributors to a bloodmeal using STR profiles — bistro"><meta name="description" content="Identifies matches between bloodmeal STR profiles and a database
of human STR profiles. The euroformix::contLikSearch() function is used
to calculate log10 likelihood ratios (log10_lrs) that are then used to
identify human contributors to each bloodmeal. For more details than are
present here, see vignette('bistro')."><meta property="og:description" content="Identifies matches between bloodmeal STR profiles and a database
of human STR profiles. The euroformix::contLikSearch() function is used
to calculate log10 likelihood ratios (log10_lrs) that are then used to
identify human contributors to each bloodmeal. For more details than are
present here, see vignette('bistro')."><meta property="og:image" content="https://duke-malaria-collaboratory.github.io/bistro/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bistro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bistro.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/step-by-step.html">Run bistro step-by-step</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/duke-malaria-collaboratory/bistro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify human contributors to a bloodmeal using STR profiles</h1>
      <small class="dont-index">Source: <a href="https://github.com/duke-malaria-collaboratory/bistro/blob/main/R/bistro.R" class="external-link"><code>R/bistro.R</code></a></small>
      <div class="d-none name"><code>bistro.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identifies matches between bloodmeal STR profiles and a database
of human STR profiles. The <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code> function is used
to calculate log10 likelihood ratios (log10_lrs) that are then used to
identify human contributors to each bloodmeal. For more details than are
present here, see <code><a href="../articles/bistro.html">vignette('bistro')</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bistro</span><span class="op">(</span></span>
<span>  <span class="va">bloodmeal_profiles</span>,</span>
<span>  <span class="va">human_profiles</span>,</span>
<span>  <span class="va">kit</span>,</span>
<span>  <span class="va">peak_thresh</span>,</span>
<span>  pop_allele_freqs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  calc_allele_freqs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bloodmeal_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  human_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rm_twins <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rm_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AMEL"</span><span class="op">)</span>,</span>
<span>  model_degrad <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  model_bw_stutt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  model_fw_stutt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  difftol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_limit <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  return_lrs <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bloodmeal-profiles">bloodmeal_profiles<a class="anchor" aria-label="anchor" href="#arg-bloodmeal-profiles"></a></dt>
<dd><p>Tibble or data frame with alleles for all
bloodmeals in reference database including 4 columns: SampleName, Marker,
Allele, Height. Height must be numeric or coercible to numeric.</p></dd>


<dt id="arg-human-profiles">human_profiles<a class="anchor" aria-label="anchor" href="#arg-human-profiles"></a></dt>
<dd><p>Tibble or data frame with alleles for all humans in
reference database including three columns: SampleName, Marker, Allele.</p></dd>


<dt id="arg-kit">kit<a class="anchor" aria-label="anchor" href="#arg-kit"></a></dt>
<dd><p>STR kit name from euroformix. To see a list of all kits embedded
in euroformix use <code><a href="https://rdrr.io/pkg/euroformix/man/getKit.html" class="external-link">euroformix::getKit()</a></code>. If your kit is not included, see
vignette("bistro") for details on how to include your own kit.</p></dd>


<dt id="arg-peak-thresh">peak_thresh<a class="anchor" aria-label="anchor" href="#arg-peak-thresh"></a></dt>
<dd><p>Allele peak height threshold in RFUs. All peaks under this
threshold will be filtered out. If prior filtering was performed, this
number should be equal to or greater than that number. Also used for
<code>threshT</code> argument in <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>.</p></dd>


<dt id="arg-pop-allele-freqs">pop_allele_freqs<a class="anchor" aria-label="anchor" href="#arg-pop-allele-freqs"></a></dt>
<dd><p>Tibble or data frame where the first column is the
STR allele and the following columns are the frequency of that allele for
different markers. Alleles that do not exist for a given marker are coded
as NA. If NULL and <code>calc_allele_freqs = TRUE</code>, then population allele
frequencies will be calculated from <code>human_profiles</code>.</p></dd>


<dt id="arg-calc-allele-freqs">calc_allele_freqs<a class="anchor" aria-label="anchor" href="#arg-calc-allele-freqs"></a></dt>
<dd><p>A boolean indicating whether or not to calculate
allele frequencies from <code>human_profiles</code>. If FALSE, a <code>pop_allele_freqs</code>
input is required. Default: FALSE</p></dd>


<dt id="arg-bloodmeal-ids">bloodmeal_ids<a class="anchor" aria-label="anchor" href="#arg-bloodmeal-ids"></a></dt>
<dd><p>Vector of bloodmeal ids from the SampleName column in
<code>bloodmeal_profiles</code> for which to compute log10_lrs. If NULL, all ids in
the input dataframe will be used. Default: NULL</p></dd>


<dt id="arg-human-ids">human_ids<a class="anchor" aria-label="anchor" href="#arg-human-ids"></a></dt>
<dd><p>Vector of human ids from the SampleName column in
<code>human_profiles</code> for which to compute log10_lrs. If NULL, all ids in the
input dataframe will be used. Default: NULL</p></dd>


<dt id="arg-rm-twins">rm_twins<a class="anchor" aria-label="anchor" href="#arg-rm-twins"></a></dt>
<dd><p>A boolean indicating whether or not to remove likely twins
(identical STR profiles) from the human database prior to identifying
matches. Default: TRUE</p></dd>


<dt id="arg-rm-markers">rm_markers<a class="anchor" aria-label="anchor" href="#arg-rm-markers"></a></dt>
<dd><p>A vector indicating what markers should be removed prior to
calculating log10LRs. NULL to include all markers. By default, for the
bistro function AMEL is removed as it is not standard to include it in LR
calculations.</p></dd>


<dt id="arg-model-degrad">model_degrad<a class="anchor" aria-label="anchor" href="#arg-model-degrad"></a></dt>
<dd><p>A boolean indicating whether or not to model peak
degradation. Used for <code>modelDegrad</code> argument in
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>. Default: TRUE</p></dd>


<dt id="arg-model-bw-stutt">model_bw_stutt<a class="anchor" aria-label="anchor" href="#arg-model-bw-stutt"></a></dt>
<dd><p>A boolean indicating whether or not to model peak
backward stutter. Used for <code>modelBWstutt</code> argument in
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>. Default: FALSE</p></dd>


<dt id="arg-model-fw-stutt">model_fw_stutt<a class="anchor" aria-label="anchor" href="#arg-model-fw-stutt"></a></dt>
<dd><p>A boolean indicating whether or not to model peak
forward stutter. Used for <code>modelFWstutt</code> argument in
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>. Default: FALSE</p></dd>


<dt id="arg-difftol">difftol<a class="anchor" aria-label="anchor" href="#arg-difftol"></a></dt>
<dd><p>Tolerance for difference in log likelihoods across 2
iterations. <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code> argument. Default: 1</p></dd>


<dt id="arg-threads">threads<a class="anchor" aria-label="anchor" href="#arg-threads"></a></dt>
<dd><p>Number of threads to use when calculating log10_lrs.
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code> argument. Default: 4</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Seed when calculating log10_lrs. <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>
argument. Default: NULL (no seed)</p></dd>


<dt id="arg-time-limit">time_limit<a class="anchor" aria-label="anchor" href="#arg-time-limit"></a></dt>
<dd><p>Time limit in minutes to run the
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code> function on 1 bloodmeal-human pair. Default:
3</p></dd>


<dt id="arg-return-lrs">return_lrs<a class="anchor" aria-label="anchor" href="#arg-return-lrs"></a></dt>
<dd><p>A boolean indicating whether or not to return log10LRs for
all bloodmeal-human pairs. Default: FALSE</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Tibble with matches for bloodmeal-human pairs including the columns
listed below. Note that if multiple matches are found for a bloodmeal,
these are included as separate rows.</p><ul><li><p><code>bloodmeal_id</code>: bloodmeal id</p></li>
<li><p><code>locus_count</code>: number of loci successfully typed in the bloodmeal</p></li>
<li><p><code>est_noc</code>: estimated number of contributors to the bloodmeal</p></li>
<li><p><code>match</code>: whether a match was identified for a given bloodmeal (yes or no)</p></li>
<li><p><code>human_id</code>: If match, human id (NA otherwise)</p></li>
<li><p><code>log10_lr</code>: If match, log10 likelihood ratio (NA otherwise)</p></li>
<li><p><code>notes</code>: Why the bloodmeal does or doesn't have a match</p>
<p>If <code>return_lrs = TRUE</code>, then a named list of length 2 is returned:</p></li>
<li><p>matches - the tibble described above</p></li>
<li><p>lrs - log10LRs for each bloodmeal-human pair including some
of the columns described above and an additional column: <code>efm_noc</code>, which
is the number of contributors used as input into euroformix, which is
<code>min(est_noc, 3)</code>.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">bistro</span><span class="op">(</span><span class="va">bloodmeal_profiles</span>, <span class="va">human_profiles</span>,</span></span>
<span class="r-in"><span>  pop_allele_freqs <span class="op">=</span> <span class="va">pop_allele_freqs</span>,</span></span>
<span class="r-in"><span>  kit <span class="op">=</span> <span class="st">"ESX17"</span>, peak_thresh <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1/17 markers in kit but not in pop_allele_freqs: AMEL</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting bloodmeal profiles</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing 6 peaks under the threshold of 200 RFU.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> For 1/4 bloodmeal ids, all peaks are below the threshold</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Formatting human profiles</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Markers being used: D10S1248, D12S391, D16S539, D18S51, D19S433, D1S1656, D21S11, D22S1045, D2S1338, D2S441, D3S1358, D8S1179, FGA, SE33, TH01, VWA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating log10LRs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> # bloodmeal ids: 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> # human ids: 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bloodmeal id 1/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 1/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 2/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 3/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bloodmeal id 2/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 1/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 2/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 3/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bloodmeal id 3/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 1/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 2/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Human id 3/3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Identifying matches</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bloodmeal_id locus_count est_noc match human_id log10_lr notes      thresh_low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> evid1                 16       2 yes   P1           21.8 passed al…        9.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> evid1                 16       2 yes   P2           10.3 passed al…        9.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> evid2                  1       2 no    <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>   all log10…       <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> evid3                  8       1 no    <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>   all log10…       <span style="color: #BB0000;">NA</span>  </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zena Lapp, Christine Markwalter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

