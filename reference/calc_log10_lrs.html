<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Note that this function doesn't preprocess the bloodmeal and human profile
data. If you would like to preprocess it in the same way as is performed
internally in the bistro() function, you must run
prep_bloodmeal_profiles() and prep_human_profiles() first."><title>Calculate log10_lrs for multiple bloodmeal-human pairs — calc_log10_lrs • bistro</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate log10_lrs for multiple bloodmeal-human pairs — calc_log10_lrs"><meta property="og:description" content="Note that this function doesn't preprocess the bloodmeal and human profile
data. If you would like to preprocess it in the same way as is performed
internally in the bistro() function, you must run
prep_bloodmeal_profiles() and prep_human_profiles() first."><meta property="og:image" content="https://duke-malaria-collaboratory.github.io/bistro/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bistro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/bistro.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/duke-malaria-collaboratory/bistro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate log10_lrs for multiple bloodmeal-human pairs</h1>
      <small class="dont-index">Source: <a href="https://github.com/duke-malaria-collaboratory/bistro/blob/HEAD/R/calc_log10_lrs.R" class="external-link"><code>R/calc_log10_lrs.R</code></a></small>
      <div class="d-none name"><code>calc_log10_lrs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Note that this function doesn't preprocess the bloodmeal and human profile
data. If you would like to preprocess it in the same way as is performed
internally in the <code><a href="bistro.html">bistro()</a></code> function, you must run
<code><a href="prep_bloodmeal_profiles.html">prep_bloodmeal_profiles()</a></code> and <code><a href="prep_human_profiles.html">prep_human_profiles()</a></code> first.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_log10_lrs</span><span class="op">(</span></span>
<span>  <span class="va">bloodmeal_profiles</span>,</span>
<span>  <span class="va">human_profiles</span>,</span>
<span>  <span class="va">pop_allele_freqs</span>,</span>
<span>  <span class="va">kit</span>,</span>
<span>  <span class="va">peak_thresh</span>,</span>
<span>  bloodmeal_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  human_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model_degrad <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  model_bw_stutt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  model_fw_stutt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  difftol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  time_limit <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>bloodmeal_profiles</dt>
<dd><p>Tibble or data frame with alleles for all bloodmeals in reference
database including 4 columns: SampleName, Marker, Allele, Height. Height
must be numeric or coercible to numeric.</p></dd>


<dt>human_profiles</dt>
<dd><p>Tibble or data frame with alleles for all humans in reference
database including three columns: SampleName, Marker, Allele.</p></dd>


<dt>pop_allele_freqs</dt>
<dd><p>Tibble or data frame where the first column is the STR allele
and the following columns are the frequency of that allele for different
markers. Alleles that do not exist for a given marker are coded as NA. If
NULL and <code>calc_allele_freqs = TRUE</code>, then population allele frequencies
will be calculated from <code>human_profiles</code>.</p></dd>


<dt>kit</dt>
<dd><p>STR kit name from euroformix. To see a list of all kits embedded
in euroformix use <code><a href="https://rdrr.io/pkg/euroformix/man/getKit.html" class="external-link">euroformix::getKit()</a></code>. If your kit is not included, see
vignette("bistro") for details on how to include your own kit.</p></dd>


<dt>peak_thresh</dt>
<dd><p>Allele peak height threshold in RFUs. All peaks under this
threshold will be filtered out. If prior filtering was performed, this
number should be equal to or greater than that number. Also used for
<code>threshT</code> argument in <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>.</p></dd>


<dt>bloodmeal_ids</dt>
<dd><p>Vector of bloodmeal ids from the SampleName column in
<code>bloodmeal_profiles</code> for which to compute log10_lrs. If NULL, all ids in
the input dataframe will be used. Default: NULL</p></dd>


<dt>human_ids</dt>
<dd><p>Vector of human ids from the SampleName column in
<code>human_profiles</code> for which to compute log10_lrs. If NULL, all ids in the
input dataframe will be used. Default: NULL</p></dd>


<dt>model_degrad</dt>
<dd><p>A boolean indicating whether or not to model peak
degradation. Used for <code>modelDegrad</code> argument in
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>. Default: TRUE</p></dd>


<dt>model_bw_stutt</dt>
<dd><p>A boolean indicating whether or not to model peak
backward stutter. Used for <code>modelBWstutt</code> argument in
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>. Default: FALSE</p></dd>


<dt>model_fw_stutt</dt>
<dd><p>A boolean indicating whether or not to model peak
forward stutter. Used for <code>modelFWstutt</code> argument in
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>. Default: FALSE</p></dd>


<dt>difftol</dt>
<dd><p>Tolerance for difference in log likelihoods across 2
iterations. <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code> argument. Default: 1</p></dd>


<dt>threads</dt>
<dd><p>Number of threads to use when calculating log10_lrs.
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code> argument. Default: 4</p></dd>


<dt>seed</dt>
<dd><p>Seed when calculating log10_lrs. <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>
argument. Default: 1</p></dd>


<dt>time_limit</dt>
<dd><p>Time limit in minutes to run the
<code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code> function on 1 bloodmeal-human pair. Default:
3</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A tibble with the same output as for <code><a href="bistro.html">bistro()</a></code>, except there is no
match column and every bloodmeal-human pair with the calculated log10_lr is
included. The only additional column is <code>efm_noc</code> which is the number of
contributors used for <code><a href="https://rdrr.io/pkg/euroformix/man/contLikSearch.html" class="external-link">euroformix::contLikSearch()</a></code>. This has a maximum
value of 3.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zena Lapp, Christine Markwalter.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

